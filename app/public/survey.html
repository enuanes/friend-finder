<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <!-- Link to Materialize CSS -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/css/materialize.min.css">
        <!-- Link to Materialize icons -->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <!--Let browser know website is optimized for mobile-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- Added link to the jQuery Library -->
        <script src="http://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
        <!-- Compiled and minified JavaScript -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/js/materialize.min.js"></script>
        <title>Friend Finder - Survey</title>
    </head>

    <body>
        <div class="container">
            <div class="card-panel yellow darken-1 col s12 center-align">
                <h4><strong>Survey Questions</strong></h4>
                <div class="card-panel left-align white">
                    <h5><strong>About You</strong></h5>
                    <br>
                    <input id="name" type="text" class="validate" required>
                    <label class="active" for="name">Name (required)</label>
                    <input id="photo" type="text" class="validate" required>
                    <label class="active" for="name">Link to Photo Image (required)</label>

                    <h5><strong>Question 1</strong></h5>
                    <p>You really enjoy Saturday classes with Todd Pickell.</p>
                    <select data-placeholder="" class="browser-default" id="q1">
                        <option value="">Choose an Option</option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                    </select>

                    <h5><strong>Question 2</strong></h5>
                    <p>You think it's okay to brush your teeth while pooping in order to save time in the morning.</p>
                    <select data-placeholder="" class="browser-default" id="q2">
                        <option value="">Choose an Option</option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                    </select>

                    <h5><strong>Question 3</strong></h5>
                    <p>You still think the word "fart" and farts in general are funny.</p>
                    <select data-placeholder="" class="browser-default" id="q3">
                        <option value="">Choose an Option</option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                    </select>

                    <h5><strong>Question 4</strong></h5>
                    <p>You think it's okay to pull out in front of someone and drive slow even though there's nobody behind them.</p>
                    <select data-placeholder="" class="browser-default" id="q4">
                        <option value="">Choose an Option</option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                    </select>

                    <h5><strong>Question 5</strong></h5>
                    <p>You believe that Donald J. Trump is an awesome person.</p>
                    <select data-placeholder="" class="browser-default" id="q5">
                        <option value="">Choose an Option</option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                    </select>

                    <h5><strong>Question 6</strong></h5>
                    <p>You believe in biting the dog that bit you, aka saving a beer for tommorrow morning's hangover.</p>
                    <select data-placeholder="" class="browser-default" id="q6">
                        <option value="">Choose an Option</option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                    </select>

                    <h5><strong>Question 7</strong></h5>
                    <p>You believe that Dane Cook is the funniest comic alive.</p>
                    <select data-placeholder="" class="browser-default" id="q7">
                        <option value="">Choose an Option</option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                    </select>

                    <h5><strong>Question 8</strong></h5>
                    <p>You think that everybody has had a fart be more than just a fart at least once in their lifetime.</p>
                    <select data-placeholder="" class="browser-default" id="q8">
                        <option value="">Choose an Option</option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                    </select>

                    <h5><strong>Question 9</strong></h5>
                    <p>You believe that if you're not first you're last.</p>
                    <select data-placeholder="" class="browser-default" id="q9">
                        <option value="">Choose an Option</option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                    </select>

                    <h5><strong>Question 10</strong></h5>
                    <p>You think that Tom Brady has a very punchable face.</p>
                    <select data-placeholder="" class="browser-default" id="q10">
                        <option value="">Choose an Option</option>
                        <option value="1">1 (Strongly Disagree)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5 (Strongly Agree)</option>
                    </select>
                    <br>
                     <!-- Materialize Modal Trigger/Submit Button -->
                     <button type="submit" data-target="modal1" class="waves-effect waves-light btn modal-trigger cyan lighten-1" id="submitBtn">Submit</button>
                </div>
            </div>

            <div class="col s4">
                <p><a href="api/friends">API Friends List</a> | <a href="https://github.com/enuanes/friend-finder" target="_blank">GitHub Repo</a></p>
            </div>

            <!-- Materialize Modal Structure -->
            <div id="modal1" class="modal">
                <div class="modal-content">
                    <h4>Meet Your New BFF</h4>
                    <h5 id="matchName"></h5>
                    <img id="matchPic" src="" alt="No Image" width="250px">
                </div>

                <div class="modal-footer">
                    <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Done</a>
                </div>
            </div>
        </div>

        <!-- Grabs information and sends it to the server -->
        <script type="text/javascript">
            $(document).ready(function() {
                $("#submitBtn").on("click", function() {
                    // Form validation
                    function validateForm() {
                        var isValid = true;
                        $('.validate').each(function() {
                            if ($(this).val() === '') {
                                isValid = false;
                            }
                        });
                        $('.browser-default').each(function() {
                            if ($(this).val() === "") {
                                isValid = false;
                            }
                        });
                        return isValid;
                    }
                    // If everything is filled
                    if (validateForm() == true) {
                        // Creates a new friend from the values submitted
                        var newFriend = {
                            name: $('#name').val().trim(),
                            profilePic: $('#photo').val().trim(),
                            scores: [
                                $('#q1').val(),
                                $('#q2').val(),
                                $('#q3').val(),
                                $('#q4').val(),
                                $('#q5').val(),
                                $('#q6').val(),
                                $('#q7').val(),
                                $('#q8').val(),
                                $('#q9').val(),
                                $('#q10').val(),
                            ]
                        };
                        // Grabs current URL of website
                        var currentURL = window.location.origin;
                        // AJAX posts the data to friends API.
                        $.post(currentURL + "/api/friends", newFriend, function(data) {
                            //Grab the result from the AJAX post so that the best match's name and photo are displayed.
                            $("#matchName").text(data.name);
                            $("#matchPic").attr("src", data.profilePic);
                        });
                        // Show the modal with the best match
                            $('.modal').modal();
                        // Clear form after submission
                        $('#name').val("");
                        $('#photo').val("");
                        $('#q1').val("");
                        $('#q2').val("");
                        $('#q3').val("");
                        $('#q4').val("");
                        $('#q5').val("");
                        $('#q6').val("");
                        $('#q7').val("");
                        $('#q8').val("");
                        $('#q9').val("");
                        $('#q10').val("");
                    } else {
                        alert("Please fill out ALL fields before submitting survey!")
                    }
                    // Return false;
                });
            });
            </script>
    </body>
</html>